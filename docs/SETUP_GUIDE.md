# Antonio Dias Flamenco Werkstatt App - Setup Guide

## Prerequisites

Before you begin, ensure you have the following installed:

- **Node.js** (v18 or higher): https://nodejs.org/
- **npm** or **yarn** package manager
- **Expo CLI**: `npm install -g expo-cli`
- **Git**: https://git-scm.com/

For mobile development:
- **Android Studio** (for Android) or **Xcode** (for iOS/macOS)
- **Expo Go** app on your mobile device (for testing)

## Step 1: Install Dependencies

Open your terminal in the project directory and run:

```bash
npm install
```

This will install all required packages including:
- React Native & Expo
- Firebase SDK
- React Navigation
- i18n-js for multi-language support
- React Native Calendars
- And all other dependencies

## Step 2: Firebase Setup

### 2.1 Create a Firebase Project

1. Go to https://console.firebase.google.com/
2. Click "Add project" and follow the wizard
3. Name it "Antonio Dias Flamenco Werkstatt" or similar
4. Enable Google Analytics (optional)

### 2.2 Enable Firebase Services

In your Firebase console:

1. **Authentication**:
   - Go to Authentication → Sign-in method
   - Enable "Email/Password" provider

2. **Firestore Database**:
   - Go to Firestore Database → Create database
   - Start in **production mode** (we'll set rules later)
   - Choose a location close to Berlin (e.g., europe-west3)

3. **Storage**:
   - Go to Storage → Get started
   - Start in production mode

### 2.3 Get Firebase Configuration

1. In Firebase Console, go to Project Settings (gear icon)
2. Scroll down to "Your apps"
3. Click the web icon (</>) to add a web app
4. Register app with nickname "Werkstatt Web"
5. Copy the firebaseConfig object

### 2.4 Configure Environment Variables

1. Copy `.env.example` to `.env`:
   ```bash
   cp .env.example .env
   ```

2. Fill in your Firebase credentials in `.env`:
   ```
   EXPO_PUBLIC_FIREBASE_API_KEY=your_api_key_here
   EXPO_PUBLIC_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com
   EXPO_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
   EXPO_PUBLIC_FIREBASE_STORAGE_BUCKET=your_project.appspot.com
   EXPO_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
   EXPO_PUBLIC_FIREBASE_APP_ID=your_app_id
   ```

## Step 3: Firestore Database Structure

Set up the following collections in Firestore:

### Collections:

1. **users**
   - Document ID: User UID (auto-generated by Auth)
   - Fields: email, firstName, lastName, role, phone, memberSince, isActive, preferredLanguage, createdAt, updatedAt

2. **events**
   - Fields: title, description, studioId, eventType, startTime, endTime, instructorId, instructorName, classLevel, classType, createdBy, isRecurring, isCancelled

3. **bookings**
   - Fields: userId, userName, studioId, startTime, endTime, status, purpose, approvedBy, approvedAt, rejectionReason, createdAt, updatedAt

4. **messages**
   - Fields: senderId, senderName, recipientIds, recipientType, subject, body, isRead, createdAt, updatedAt

5. **news**
   - Fields: title, content, imageUrl, category, publishedBy, publishedAt, isPublished, createdAt, updatedAt

6. **specialEvents**
   - Fields: title, description, location, isOffsite, country, startDate, endDate, imageUrl, registrationDeadline, maxParticipants, currentParticipants, price, createdBy, createdAt, updatedAt

### Firestore Security Rules:

Go to Firestore Database → Rules and paste:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    function isSignedIn() {
      return request.auth != null;
    }
    
    function isAdmin() {
      return isSignedIn() && get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
    
    function isOwner(userId) {
      return isSignedIn() && request.auth.uid == userId;
    }
    
    match /users/{userId} {
      allow read: if isSignedIn();
      allow create: if isSignedIn();
      allow update: if isOwner(userId) || isAdmin();
      allow delete: if isAdmin();
    }
    
    match /events/{eventId} {
      allow read: if isSignedIn();
      allow write: if isAdmin();
    }
    
    match /bookings/{bookingId} {
      allow read: if isSignedIn();
      allow create: if isSignedIn();
      allow update: if isAdmin() || isOwner(resource.data.userId);
      allow delete: if isAdmin();
    }
    
    match /messages/{messageId} {
      allow read: if isSignedIn() && (
        request.auth.uid == resource.data.senderId ||
        request.auth.uid in resource.data.recipientIds
      );
      allow create: if isSignedIn();
      allow update: if isAdmin();
      allow delete: if isAdmin();
    }
    
    match /news/{newsId} {
      allow read: if true;
      allow write: if isAdmin();
    }
    
    match /specialEvents/{eventId} {
      allow read: if true;
      allow write: if isAdmin();
    }
  }
}
```

## Step 4: Create Admin User

After setting up Firebase:

1. Run the app: `npm start`
2. Create a new account through the app
3. Go to Firebase Console → Firestore Database
4. Find your user document in the `users` collection
5. Edit the document and change `role` from `"member"` to `"admin"`
6. Restart the app - you now have admin access!

## Step 5: Run the Application

### For Web:
```bash
npm run web
```

### For Mobile (Development):
```bash
npm start
```
Then scan the QR code with:
- **iOS**: Camera app
- **Android**: Expo Go app

### For Android Build:
```bash
npm run android
```

### For iOS Build (macOS only):
```bash
npm run ios
```

## Step 6: Testing the Application

### Test User Accounts:
1. Create at least 3 test accounts (1 admin, 1 instructor, 1 member)
2. Test booking flow with member account
3. Approve/reject bookings with admin account

### Test Features:
- ✅ User registration and login
- ✅ Calendar view with both studios
- ✅ Studio booking with time validation
- ✅ Booking approval workflow (admin)
- ✅ Messaging between users
- ✅ News feed creation and viewing
- ✅ Special events management
- ✅ Language switching (DE/EN/ES)

## Step 7: Customization

### Brand Colors:
Edit `src/constants/theme.ts` to adjust colors based on the website

### Studio Names:
Edit `src/constants/studios.ts` to modify studio names and capacities

### Translations:
Edit files in `src/locales/` (de.ts, en.ts, es.ts) to update translations

### German School Holidays:
Update `src/utils/dateUtils.ts` → `getBerlinSchoolHolidays()` function with accurate 2026 dates

## Step 8: Deployment

### Web Deployment:
```bash
npm run build:web
```
Deploy the `web-build` folder to:
- Netlify
- Vercel
- Firebase Hosting
- Any static hosting service

### Mobile App Deployment:

#### Android (Google Play Store):
```bash
expo build:android
```

#### iOS (Apple App Store):
```bash
expo build:ios
```

Follow Expo's documentation for app store submission:
https://docs.expo.dev/distribution/introduction/

## Troubleshooting

### Common Issues:

1. **"Cannot find module" errors**:
   - Delete `node_modules` and run `npm install` again
   - Clear cache: `expo start -c`

2. **Firebase errors**:
   - Verify `.env` file has correct credentials
   - Check Firebase console for enabled services
   - Verify Firestore security rules are published

3. **TypeScript errors**:
   - Run `npm install` to get all type definitions
   - Restart your IDE/editor

4. **Calendar not showing events**:
   - Check Firestore security rules
   - Verify events collection has data
   - Check browser console for errors

## Support & Contact

**Studio Owner**: Antonio Dias  
**Email**: mail@antoniodias.de  
**Phone**: +49 177 7855744  
**Website**: https://www.flamenco-werkstatt.de/  
**Address**: Frankfurter Allee 110, 10247 Berlin, Germany

## Next Steps

1. Add sample data to Firestore (events, news items)
2. Test all user flows thoroughly
3. Gather feedback from Antonio and instructors
4. Implement additional features as needed
5. Prepare for production deployment

## Additional Features to Consider

- Push notifications for booking approvals
- Payment integration for class fees
- Attendance tracking
- Member profiles with photos
- Class recordings/videos library
- Integration with existing website
- WhatsApp/Telegram notifications
- Automatic reminder emails

---

**Built with ❤️ for Antonio Dias Flamenco Werkstatt**
